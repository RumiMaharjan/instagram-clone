{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"C:/Users/97798/Desktop/react/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from'react';import{Button}from\"@material-ui/core\";import firebase from\"firebase\";import{storage,db}from\"../firebase\";import\"../css/ImageUpload.css\";var ImageUpload=function ImageUpload(_ref){var username=_ref.username;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),caption=_useState2[0],setCaption=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var handleChange=function handleChange(e){if(e.target.files[0]){setImage(e.target.files[0]);}};var handleUpload=function handleUpload(){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){// progress function ...\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){//error function ...\nconsole.log(error);alert(error.message);},function(){//complete function ...\nstorage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){//post image inside db\ndb.collection(\"posts\").add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageUrl:url,username:username});setProgress(0);setCaption(\"\");setImage(null);});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"imageUpload\",children:[/*#__PURE__*/_jsx(\"progress\",{value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter a caption..\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(Button,{onClick:handleUpload,children:\"Upload\"})]});};export default ImageUpload;","map":{"version":3,"sources":["C:/Users/97798/Desktop/react/instagram-clone/src/components/ImageUpload.js"],"names":["useState","Button","firebase","storage","db","ImageUpload","username","caption","setCaption","progress","setProgress","image","setImage","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"mappings":"2PAAA,OAAQA,QAAR,KAAuB,OAAvB,CACA,OAAQC,MAAR,KAAqB,mBAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,OAAQC,OAAR,CAAiBC,EAAjB,KAA0B,aAA1B,CAEA,MAAO,wBAAP,CAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,MAAgB,IAAdC,CAAAA,QAAc,MAAdA,QAAc,eACFN,QAAQ,CAAC,EAAD,CADN,wCACzBO,OADyB,eAChBC,UADgB,8BAEAR,QAAQ,CAAC,CAAD,CAFR,yCAEzBS,QAFyB,eAEfC,WAFe,8BAGNV,QAAQ,CAAC,IAAD,CAHF,yCAGzBW,KAHyB,eAGlBC,QAHkB,eAKhC,GAAMC,CAAAA,YAAY,CAAC,QAAbA,CAAAA,YAAa,CAACC,CAAD,CAAK,CACpB,GAAGA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAH,CAAqB,CACjBJ,QAAQ,CAACE,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACH,CACJ,CAJD,CAMA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAI,CACrB,GAAMC,CAAAA,UAAU,CAAGf,OAAO,CAACgB,GAAR,kBAAsBR,KAAK,CAACS,IAA5B,GAAoCC,GAApC,CAAwCV,KAAxC,CAAnB,CAEAO,UAAU,CAACI,EAAX,CACI,eADJ,CAEI,SAACC,QAAD,CAAa,CACT;AACA,GAAMd,CAAAA,QAAQ,CAAEe,IAAI,CAACC,KAAL,CACfF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GADpC,CAAhB,CAGAjB,WAAW,CAACD,QAAD,CAAX,CACH,CARL,CASI,SAACmB,KAAD,CAAU,CACN;AACAC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACAG,KAAK,CAACH,KAAK,CAACI,OAAP,CAAL,CACH,CAbL,CAcI,UAAM,CACF;AAEA7B,OAAO,CACNgB,GADD,CACK,QADL,EAECc,KAFD,CAEOtB,KAAK,CAACS,IAFb,EAGCc,cAHD,GAICC,IAJD,CAIM,SAAAC,GAAG,CAAI,CACT;AACAhC,EAAE,CAACiC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACvBC,SAAS,CAAErC,QAAQ,CAACsC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADY,CAEvBnC,OAAO,CAAEA,OAFc,CAGvBoC,QAAQ,CAAEP,GAHa,CAIvB9B,QAAQ,CAAEA,QAJa,CAA3B,EAOAI,WAAW,CAAC,CAAD,CAAX,CACAF,UAAU,CAAC,EAAD,CAAV,CACAI,QAAQ,CAAC,IAAD,CAAR,CACH,CAhBD,EAiBH,CAlCL,EAoCH,CAvCD,CAyCA,mBACI,aAAK,SAAS,CAAC,aAAf,wBACI,iBAAW,KAAK,CAAEH,QAAlB,CAA4B,GAAG,CAAC,KAAhC,EADJ,cAEG,cAAO,IAAI,CAAC,MAAZ,CACA,WAAW,CAAC,mBADZ,CAEA,QAAQ,CAAE,kBAAAmC,KAAK,QAAIpC,CAAAA,UAAU,CAACoC,KAAK,CAAC7B,MAAN,CAAa8B,KAAd,CAAd,EAFf,CAGA,KAAK,CAAEtC,OAHP,EAFH,cAMG,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEM,YAA7B,EANH,cAOG,KAAC,MAAD,EAAQ,OAAO,CAAEI,YAAjB,oBAPH,GADJ,CAaH,CAjED,CAmEA,cAAeZ,CAAAA,WAAf","sourcesContent":["import {useState} from 'react';\r\nimport {Button} from \"@material-ui/core\";\r\nimport firebase from \"firebase\";\r\nimport {storage, db} from \"../firebase\";\r\n\r\nimport \"../css/ImageUpload.css\";\r\n\r\nconst ImageUpload = ({username}) => {\r\n    const [caption, setCaption] = useState('');\r\n    const [progress, setProgress] = useState(0);\r\n    const [image, setImage] = useState(null);\r\n\r\n    const handleChange=(e)=>{\r\n        if(e.target.files[0]){\r\n            setImage(e.target.files[0]);\r\n        }\r\n    };\r\n\r\n    const handleUpload = ()=>{\r\n        const uploadTask = storage.ref(`images/${image.name}`).put(image);\r\n\r\n        uploadTask.on(\r\n            \"state_changed\",\r\n            (snapshot)=> {\r\n                // progress function ...\r\n                const progress= Math.round(\r\n                (snapshot.bytesTransferred / snapshot.totalBytes) * 100\r\n                );\r\n                setProgress(progress);\r\n            },\r\n            (error)=> {\r\n                //error function ...\r\n                console.log(error);\r\n                alert(error.message);\r\n            },\r\n            () => {\r\n                //complete function ...\r\n\r\n                storage\r\n                .ref(\"images\")\r\n                .child(image.name)\r\n                .getDownloadURL()\r\n                .then(url => {\r\n                    //post image inside db\r\n                    db.collection(\"posts\").add({\r\n                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n                        caption: caption, \r\n                        imageUrl: url,\r\n                        username: username\r\n                    });\r\n\r\n                    setProgress(0);\r\n                    setCaption(\"\");\r\n                    setImage(null);\r\n                })\r\n            }\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"imageUpload\">\r\n            <progress  value={progress} max=\"100\"/>\r\n           <input type=\"text\" \r\n           placeholder='Enter a caption..'\r\n           onChange={event => setCaption(event.target.value)}\r\n           value={caption}/>\r\n           <input type=\"file\" onChange={handleChange}/>\r\n           <Button onClick={handleUpload}>\r\n               Upload\r\n           </Button>      \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ImageUpload\r\n"]},"metadata":{},"sourceType":"module"}